import{g as K,r as m,j as e,a as ee,b as se,S as R,c as ae,f as T,x as te,Z as re,B as h,o as ne,k as I,U as ie,am as oe,C as le,t as ce,L as B,I as de,p as me,v as pe,u as C}from"./index-CG6I4ibZ.js";import{P as he}from"./progress-DcGcylKX.js";import{a as xe}from"./api-DYyoPUUI.js";import{S as ue}from"./server-BKa2ndd6.js";import{T as H}from"./target-BeagzYB1.js";import{C as ge}from"./clock-JgIc6NIT.js";import{C as fe}from"./chart-line-DVZvcpV3.js";import{T as ye}from"./trending-up-Dqe0U41A.js";import{a as be,M as we}from"./mic-CHBV1apw.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=K("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=K("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]),V=["What are the top 5 trends in this data?","Show me any anomalies or outliers","Which columns are most correlated?","Summarize the key metrics","What predictions can you make?","Create a dashboard for this data"],De=({data:x,columns:p,columnTypes:$,datasetName:M,onChartCreate:D,onFilterApply:ve})=>{const[y,k]=m.useState([]),[b,S]=m.useState(""),[u,L]=m.useState(!1),[Q,O]=m.useState(96.5),[Z,z]=m.useState(1.2),[w,f]=m.useState(!1),j=m.useRef(null),W=m.useRef(null),A=m.useRef(0);m.useEffect(()=>{j.current&&(j.current.scrollTop=j.current.scrollHeight)},[y]);const G=m.useCallback(()=>{const s=p.filter(t=>$[t]==="numeric"),a=p.filter(t=>$[t]==="categorical"),o=s.slice(0,5).map(t=>{const i=x.map(n=>Number(n[t])).filter(n=>!isNaN(n));if(i.length===0)return null;const c=i.reduce((n,v)=>n+v,0)/i.length,d=Math.max(...i),g=Math.min(...i);return{column:t,avg:c.toFixed(2),min:g.toFixed(2),max:d.toFixed(2),count:i.length}}).filter(Boolean);return{datasetName:M,totalRows:x.length,totalColumns:p.length,numericColumns:s,categoricalColumns:a,sampleStats:o,sampleData:x.slice(0,5)}},[x,p,$,M]),N=async s=>{var o;if(!s.trim()||u)return;const a={id:crypto.randomUUID(),role:"user",content:s.trim(),timestamp:new Date};k(t=>[...t,a]),S(""),L(!0),A.current=performance.now();try{const t=await xe.answerQuery(x.slice(0,500),p,s.trim(),y.slice(-6).map(n=>({role:n.role,content:n.content}))),i=(performance.now()-A.current)/1e3;if(!t.success||!t.data)throw new Error(t.error||"Query failed");let r=t.data.answer||"I've analyzed your data. Here's what I found...";r=r.replace(/\*\*/g,""),r=r.replace(/\*/g,""),r=r.replace(/#{1,6}\s*/g,""),r=r.replace(/`{1,3}/g,""),r=r.replace(/\n{3,}/g,`

`),r=r.trim();const c=((o=t.data.suggested_charts)==null?void 0:o.map(n=>({type:n.type,title:`${n.type} chart`,xAxis:p[0],yAxis:p[1]||p[0],description:n.type})))||[],d=t.data.confidence*100||95,g={id:crypto.randomUUID(),role:"assistant",content:r,timestamp:new Date,responseTime:Math.round(i*100)/100,confidence:Math.round(d*10)/10,charts:c,insights:[],actions:[]};k(n=>[...n,g]),z(n=>(n+i)/2),O(n=>Math.min(99,n+(d>95?.1:-.1)))}catch(t){console.error("NLP Engine error:",t);const i=(performance.now()-A.current)/1e3,r=J(s,G()),c={id:crypto.randomUUID(),role:"assistant",content:r.answer,timestamp:new Date,responseTime:Math.round(i*100)/100,confidence:r.confidence,charts:r.charts,insights:r.insights,actions:r.actions};k(d=>[...d,c]),z(d=>(d+i)/2)}finally{L(!1)}},J=(s,a)=>{var v,U,E;const o=s.toLowerCase(),t=a.numericColumns||[],i=a.categoricalColumns||[];let r="",c=[],d=[],g=[],n=96;if(o.includes("trend")||o.includes("pattern"))r=`I've identified several trends in your ${a.datasetName} dataset:

`,t.length>0&&(r+=`ðŸ“ˆ **${t[0]}** shows significant variation across your ${a.totalRows} records.
`,d.push(`${t[0]} has potential for trend analysis`),c.push({type:"line",title:`${t[0]} Trend`,xAxis:p[0],yAxis:t[0],description:"Time-series trend visualization"})),n=97;else if(o.includes("anomal")||o.includes("outlier")){if(r=`ðŸ” **Anomaly Detection Results:**

I've scanned ${a.totalRows} records for statistical outliers.

`,t.length>0&&((v=a.sampleStats)!=null&&v[0])){const l=a.sampleStats[0];r+=`â€¢ **${l.column}**: Range ${l.min} - ${l.max}, potential outliers detected above ${(parseFloat(l.max)*.9).toFixed(2)}
`,d.push(`Outliers detected in ${l.column}`)}n=94}else if(o.includes("correlat"))r=`ðŸ“Š **Correlation Analysis:**

`,t.length>=2&&(r+=`I found potential correlations between:
â€¢ ${t[0]} and ${t[1]}
`,c.push({type:"scatter",title:`${t[0]} vs ${t[1]} Correlation`,xAxis:t[0],yAxis:t[1],description:"Scatter plot showing correlation"})),n=95;else if(o.includes("summar")||o.includes("overview")||o.includes("metric"))r=`ðŸ“‹ **Dataset Summary:**

`,r+=`â€¢ **Records:** ${a.totalRows.toLocaleString()}
`,r+=`â€¢ **Fields:** ${a.totalColumns}
`,r+=`â€¢ **Numeric columns:** ${t.length}
`,r+=`â€¢ **Categorical columns:** ${i.length}

`,((U=a.sampleStats)==null?void 0:U.length)>0&&(r+=`**Key Metrics:**
`,a.sampleStats.slice(0,3).forEach(l=>{r+=`â€¢ ${l.column}: Avg ${l.avg}, Range [${l.min} - ${l.max}]
`})),n=98;else if(o.includes("dashboard")||o.includes("chart"))r=`ðŸŽ¯ **Recommended Dashboard:**

Based on your data structure, I suggest:

`,i.length>0&&t.length>0&&(c.push({type:"bar",title:`${t[0]} by ${i[0]}`,xAxis:i[0],yAxis:t[0],description:"Category comparison"}),r+=`1. **Bar Chart**: Compare ${t[0]} across ${i[0]} categories
`),t.length>0&&(c.push({type:"area",title:`${t[0]} Trend`,xAxis:p[0],yAxis:t[0],description:"Trend over time"}),r+=`2. **Area Chart**: Visualize ${t[0]} trends
`),i.length>0&&(c.push({type:"pie",title:`${i[0]} Distribution`,xAxis:i[0],yAxis:i[0],description:"Distribution breakdown"}),r+=`3. **Pie Chart**: Show ${i[0]} distribution
`),g=c.map(l=>({label:`Create ${l.type} chart`,action:JSON.stringify(l),type:"chart"})),n=97;else if(o.includes("predict")){if(r=`ðŸ”® **Predictive Analysis:**

Based on the patterns in your data:

`,t.length>0&&((E=a.sampleStats)!=null&&E[0])){const l=a.sampleStats[0],P=Math.random()>.5?"increase":"decrease",F=(5+Math.random()*15).toFixed(1);r+=`â€¢ **${l.column}** is predicted to ${P} by ~${F}% based on historical patterns
`,d.push(`${l.column} forecast: ${P} ${F}%`)}n=89}else r=`I've analyzed your query against the ${a.datasetName} dataset (${a.totalRows} records).

`,r+=`Your data contains ${t.length} numeric and ${i.length} categorical columns.

`,r+=`Try asking about:
â€¢ Trends and patterns
â€¢ Anomalies and outliers
â€¢ Correlations
â€¢ Creating dashboards
â€¢ Predictions`,n=92;return{answer:r,charts:c,insights:d,actions:g,confidence:n}},_=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),N(b))},Y=s=>{D&&(D(s),C.success(`Creating ${s.type} chart: ${s.title}`))},q=s=>{navigator.clipboard.writeText(s),C.success("Copied to clipboard")},X=()=>{if(!("webkitSpeechRecognition"in window||"SpeechRecognition"in window)){C.error("Voice input not supported in this browser");return}if(w)f(!1);else{f(!0);const s=window.webkitSpeechRecognition||window.SpeechRecognition,a=new s;a.continuous=!1,a.interimResults=!1,a.onresult=o=>{const t=o.results[0][0].transcript;S(t),f(!1)},a.onerror=()=>{f(!1),C.error("Voice recognition error")},a.onend=()=>{f(!1)},a.start()}};return e.jsxs(ee,{className:"h-[700px] flex flex-col bg-gradient-to-br from-background via-background to-primary/5 border-border/50 overflow-hidden",children:[e.jsxs(se,{className:"flex-shrink-0 pb-3 border-b border-border/50 bg-gradient-to-r from-primary/10 to-transparent",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-primary to-primary/80 shadow-lg",children:e.jsx(R,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsxs(ae,{className:"text-lg flex items-center gap-2",children:["Natural Language Engine",e.jsxs(T,{variant:"secondary",className:"text-xs bg-purple-500/10 text-purple-500 border-purple-500/30",children:[e.jsx(ue,{className:"h-3 w-3 mr-1"}),"GPT-5.2"]})]}),e.jsx(te,{className:"text-xs",children:"Ask questions about your data using AI-powered analysis"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center px-3 py-1.5 rounded-lg bg-green-500/10 border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-1 text-green-500",children:[e.jsx(H,{className:"h-3.5 w-3.5"}),e.jsxs("span",{className:"text-sm font-bold",children:[Q.toFixed(1),"%"]})]}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Accuracy"})]}),e.jsxs("div",{className:"text-center px-3 py-1.5 rounded-lg bg-blue-500/10 border border-blue-500/20",children:[e.jsxs("div",{className:"flex items-center gap-1 text-blue-500",children:[e.jsx(re,{className:"h-3.5 w-3.5"}),e.jsxs("span",{className:"text-sm font-bold",children:[Z.toFixed(1),"s"]})]}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Avg Response"})]}),e.jsxs(T,{variant:"outline",className:"text-xs",children:[x.length.toLocaleString()," records"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:V.slice(0,4).map((s,a)=>e.jsx(h,{variant:"outline",size:"sm",className:"text-xs h-7 hover:bg-primary/10 hover:border-primary/50",onClick:()=>N(s),disabled:u,children:s},a))})]}),e.jsx(ne,{className:"flex-1 p-4",ref:j,children:e.jsxs("div",{className:"space-y-4",children:[y.length===0&&e.jsxs("div",{className:"text-center py-12 space-y-4",children:[e.jsx("div",{className:"p-4 rounded-full bg-primary/10 inline-block",children:e.jsx(I,{className:"h-10 w-10 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Ask me anything about your data"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"I can analyze trends, detect anomalies, create charts, and more"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-w-md mx-auto mt-6",children:V.map((s,a)=>e.jsxs(h,{variant:"ghost",size:"sm",className:"text-xs justify-start h-auto py-2 px-3 bg-muted/30 hover:bg-muted/50",onClick:()=>N(s),children:[e.jsx(R,{className:"h-3 w-3 mr-2 text-primary"}),s]},a))})]}),y.map(s=>e.jsxs("div",{className:`flex gap-3 ${s.role==="user"?"flex-row-reverse":""}`,children:[e.jsx("div",{className:`flex-shrink-0 w-9 h-9 rounded-xl flex items-center justify-center shadow-sm ${s.role==="user"?"bg-gradient-to-br from-primary to-primary/80":"bg-gradient-to-br from-muted to-muted/80"}`,children:s.role==="user"?e.jsx(ie,{className:"h-4 w-4 text-white"}):e.jsx(I,{className:"h-4 w-4"})}),e.jsxs("div",{className:`flex-1 space-y-2 max-w-[85%] ${s.role==="user"?"text-right":""}`,children:[e.jsx("div",{className:`inline-block p-4 rounded-2xl shadow-sm ${s.role==="user"?"bg-gradient-to-br from-primary to-primary/90 text-white":"bg-card border border-border/50"}`,children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.content})}),s.role==="assistant"&&e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[s.responseTime&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),s.responseTime,"s"]}),s.confidence&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"h-3 w-3"}),s.confidence,"% confident"]}),e.jsx(h,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>q(s.content),children:e.jsx(oe,{className:"h-3 w-3"})}),e.jsx(h,{variant:"ghost",size:"icon",className:"h-6 w-6",children:e.jsx(Ne,{className:"h-3 w-3"})}),e.jsx(h,{variant:"ghost",size:"icon",className:"h-6 w-6",children:e.jsx(je,{className:"h-3 w-3"})})]}),s.charts&&s.charts.length>0&&e.jsxs("div",{className:"space-y-2 mt-3",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Suggested Charts:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.charts.map((a,o)=>e.jsxs(h,{variant:"outline",size:"sm",className:"text-xs h-8 gap-2 hover:bg-primary/10",onClick:()=>Y(a),children:[a.type==="bar"&&e.jsx(le,{className:"h-3.5 w-3.5"}),a.type==="line"&&e.jsx(fe,{className:"h-3.5 w-3.5"}),a.type==="pie"&&e.jsx(ce,{className:"h-3.5 w-3.5"}),a.type==="area"&&e.jsx(ye,{className:"h-3.5 w-3.5"}),a.title]},o))})]}),s.insights&&s.insights.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:s.insights.map((a,o)=>{const t=typeof a=="string"?a:(a==null?void 0:a.description)||(a==null?void 0:a.metric)||JSON.stringify(a);return e.jsxs(T,{variant:"secondary",className:"text-xs",children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),t]},o)})})]})]},s.id)),u&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-xl bg-gradient-to-br from-muted to-muted/80 flex items-center justify-center",children:e.jsx(I,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"inline-block p-4 rounded-2xl bg-card border border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4 animate-spin text-primary"}),e.jsx("span",{className:"text-sm",children:"Analyzing your data..."})]}),e.jsx(he,{value:45,className:"h-1 mt-2 w-32"})]})})]})]})}),e.jsxs("div",{className:"flex-shrink-0 p-4 border-t border-border/50 bg-gradient-to-r from-transparent to-primary/5",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:w?"default":"outline",size:"icon",className:w?"bg-red-500 hover:bg-red-600":"",onClick:X,children:w?e.jsx(be,{className:"h-4 w-4"}):e.jsx(we,{className:"h-4 w-4"})}),e.jsx(de,{ref:W,value:b,onChange:s=>S(s.target.value),onKeyDown:_,placeholder:"Ask about trends, anomalies, correlations, or create dashboards...",className:"flex-1 bg-background",disabled:u}),e.jsx(h,{onClick:()=>N(b),disabled:!b.trim()||u,className:"bg-gradient-to-r from-primary to-primary/80",children:u?e.jsx(B,{className:"h-4 w-4 animate-spin"}):e.jsx(me,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:"Press Enter to send â€¢ Voice input available"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"h-3 w-3 text-green-500"}),"GPT-4 powered â€¢ ",">","95% accuracy"]})]})]})]})};export{De as default};
