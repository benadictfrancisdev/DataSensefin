import{g as qe,aI as G,aJ as _e,aK as J,aL as et,aM as Ct,aN as xt,aO as At,as as D,aB as ve,aP as Tt,r as y,u as I,j as e,a as N,b as k,c as F,f as T,x as q,d as w,D as ne,aQ as Be,B as Ee,L as De,ar as ht,v as Me,C as ie,e as ce,S as Re,y as _t,n as X,T as Z,Z as Et,o as Fe,i as Dt,l as tt,E as Mt,aA as Rt,G as kt,H as Ft,J as fe,K as ge}from"./index-CG6I4ibZ.js";import{P as we}from"./progress-DcGcylKX.js";import{S as $e,a as Le,b as Ie,c as Ye,d as be}from"./select-BnHOLFni.js";import{m as Ge,a as Se}from"./api-DYyoPUUI.js";import{T as re}from"./target-BeagzYB1.js";import{S as z}from"./server-BKa2ndd6.js";import{d as se,p as le,i as pe,D as $t,h as ke,A as Lt,m as je,n as It,r as Yt,G as Wt,j as st,J as qt,e as rt,g as Bt,F as Gt,R as Pe,C as He,X as ze,Y as Ke,T as Ve,B as ft,a as gt,L as pt}from"./generateCategoricalChart-D2ZRUXeT.js";import{c as Ht,P as jt,b as yt,B as bt,S as zt,a as Kt}from"./ScatterChart-ChSpn_1T.js";import{S as Vt}from"./switch-buUSdwhU.js";import{S as Qt}from"./slider-DR0xRu3K.js";import{E as Xt}from"./eye-BitIfH2z.js";import{C as Ne}from"./circle-x-DFMCZO-o.js";import{C as Ut}from"./clock-JgIc6NIT.js";import{T as Zt}from"./trending-up-Dqe0U41A.js";import"./index-DXJAGtlO.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=qe("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=qe("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=qe("Puzzle",[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]]);function oe(s,t){var l,d,p,f;const r=_e(),a=(t==null?void 0:t.weekStartsOn)??((d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.weekStartsOn)??r.weekStartsOn??((f=(p=r.locale)==null?void 0:p.options)==null?void 0:f.weekStartsOn)??0,n=G(s),c=n.getDay(),i=(c<a?7:0)+c-a;return n.setDate(n.getDate()-i),n.setHours(0,0,0,0),n}function Ce(s){return oe(s,{weekStartsOn:1})}function Nt(s){const t=G(s),r=t.getFullYear(),a=J(s,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const n=Ce(a),c=J(s,0);c.setFullYear(r,0,4),c.setHours(0,0,0,0);const i=Ce(c);return t.getTime()>=n.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function at(s){const t=G(s);return t.setHours(0,0,0,0),t}function ts(s,t){const r=at(s),a=at(t),n=+r-et(r),c=+a-et(a);return Math.round((n-c)/Ct)}function ss(s){const t=Nt(s),r=J(s,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Ce(r)}function rs(s){return s instanceof Date||typeof s=="object"&&Object.prototype.toString.call(s)==="[object Date]"}function as(s){if(!rs(s)&&typeof s!="number")return!1;const t=G(s);return!isNaN(Number(t))}function ns(s){const t=G(s),r=J(s,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function is(s){const t=G(s);return ts(t,ns(t))+1}function cs(s){const t=G(s),r=+Ce(t)-+ss(t);return Math.round(r/xt)+1}function vt(s,t){var f,h,u,O;const r=G(s),a=r.getFullYear(),n=_e(),c=(t==null?void 0:t.firstWeekContainsDate)??((h=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((O=(u=n.locale)==null?void 0:u.options)==null?void 0:O.firstWeekContainsDate)??1,i=J(s,0);i.setFullYear(a+1,0,c),i.setHours(0,0,0,0);const l=oe(i,t),d=J(s,0);d.setFullYear(a,0,c),d.setHours(0,0,0,0);const p=oe(d,t);return r.getTime()>=l.getTime()?a+1:r.getTime()>=p.getTime()?a:a-1}function ls(s,t){var l,d,p,f;const r=_e(),a=(t==null?void 0:t.firstWeekContainsDate)??((d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(p=r.locale)==null?void 0:p.options)==null?void 0:f.firstWeekContainsDate)??1,n=vt(s,t),c=J(s,0);return c.setFullYear(n,0,a),c.setHours(0,0,0,0),oe(c,t)}function os(s,t){const r=G(s),a=+oe(r,t)-+ls(r,t);return Math.round(a/xt)+1}function C(s,t){const r=s<0?"-":"",a=Math.abs(s).toString().padStart(t,"0");return r+a}const Q={y(s,t){const r=s.getFullYear(),a=r>0?r:1-r;return C(t==="yy"?a%100:a,t.length)},M(s,t){const r=s.getMonth();return t==="M"?String(r+1):C(r+1,2)},d(s,t){return C(s.getDate(),t.length)},a(s,t){const r=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(s,t){return C(s.getHours()%12||12,t.length)},H(s,t){return C(s.getHours(),t.length)},m(s,t){return C(s.getMinutes(),t.length)},s(s,t){return C(s.getSeconds(),t.length)},S(s,t){const r=t.length,a=s.getMilliseconds(),n=Math.trunc(a*Math.pow(10,r-3));return C(n,t.length)}},ee={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},nt={G:function(s,t,r){const a=s.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});case"GGGG":default:return r.era(a,{width:"wide"})}},y:function(s,t,r){if(t==="yo"){const a=s.getFullYear(),n=a>0?a:1-a;return r.ordinalNumber(n,{unit:"year"})}return Q.y(s,t)},Y:function(s,t,r,a){const n=vt(s,a),c=n>0?n:1-n;if(t==="YY"){const i=c%100;return C(i,2)}return t==="Yo"?r.ordinalNumber(c,{unit:"year"}):C(c,t.length)},R:function(s,t){const r=Nt(s);return C(r,t.length)},u:function(s,t){const r=s.getFullYear();return C(r,t.length)},Q:function(s,t,r){const a=Math.ceil((s.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return C(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(s,t,r){const a=Math.ceil((s.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return C(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(s,t,r){const a=s.getMonth();switch(t){case"M":case"MM":return Q.M(s,t);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(s,t,r){const a=s.getMonth();switch(t){case"L":return String(a+1);case"LL":return C(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(s,t,r,a){const n=os(s,a);return t==="wo"?r.ordinalNumber(n,{unit:"week"}):C(n,t.length)},I:function(s,t,r){const a=cs(s);return t==="Io"?r.ordinalNumber(a,{unit:"week"}):C(a,t.length)},d:function(s,t,r){return t==="do"?r.ordinalNumber(s.getDate(),{unit:"date"}):Q.d(s,t)},D:function(s,t,r){const a=is(s);return t==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):C(a,t.length)},E:function(s,t,r){const a=s.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});case"EEEE":default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(s,t,r,a){const n=s.getDay(),c=(n-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(c);case"ee":return C(c,2);case"eo":return r.ordinalNumber(c,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(s,t,r,a){const n=s.getDay(),c=(n-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(c);case"cc":return C(c,t.length);case"co":return r.ordinalNumber(c,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(s,t,r){const a=s.getDay(),n=a===0?7:a;switch(t){case"i":return String(n);case"ii":return C(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});case"iiii":default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(s,t,r){const n=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(s,t,r){const a=s.getHours();let n;switch(a===12?n=ee.noon:a===0?n=ee.midnight:n=a/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(s,t,r){const a=s.getHours();let n;switch(a>=17?n=ee.evening:a>=12?n=ee.afternoon:a>=4?n=ee.morning:n=ee.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(s,t,r){if(t==="ho"){let a=s.getHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return Q.h(s,t)},H:function(s,t,r){return t==="Ho"?r.ordinalNumber(s.getHours(),{unit:"hour"}):Q.H(s,t)},K:function(s,t,r){const a=s.getHours()%12;return t==="Ko"?r.ordinalNumber(a,{unit:"hour"}):C(a,t.length)},k:function(s,t,r){let a=s.getHours();return a===0&&(a=24),t==="ko"?r.ordinalNumber(a,{unit:"hour"}):C(a,t.length)},m:function(s,t,r){return t==="mo"?r.ordinalNumber(s.getMinutes(),{unit:"minute"}):Q.m(s,t)},s:function(s,t,r){return t==="so"?r.ordinalNumber(s.getSeconds(),{unit:"second"}):Q.s(s,t)},S:function(s,t){return Q.S(s,t)},X:function(s,t,r){const a=s.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return ct(a);case"XXXX":case"XX":return U(a);case"XXXXX":case"XXX":default:return U(a,":")}},x:function(s,t,r){const a=s.getTimezoneOffset();switch(t){case"x":return ct(a);case"xxxx":case"xx":return U(a);case"xxxxx":case"xxx":default:return U(a,":")}},O:function(s,t,r){const a=s.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+it(a,":");case"OOOO":default:return"GMT"+U(a,":")}},z:function(s,t,r){const a=s.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+it(a,":");case"zzzz":default:return"GMT"+U(a,":")}},t:function(s,t,r){const a=Math.trunc(s.getTime()/1e3);return C(a,t.length)},T:function(s,t,r){const a=s.getTime();return C(a,t.length)}};function it(s,t=""){const r=s>0?"-":"+",a=Math.abs(s),n=Math.trunc(a/60),c=a%60;return c===0?r+String(n):r+String(n)+t+C(c,2)}function ct(s,t){return s%60===0?(s>0?"-":"+")+C(Math.abs(s)/60,2):U(s,t)}function U(s,t=""){const r=s>0?"-":"+",a=Math.abs(s),n=C(Math.trunc(a/60),2),c=C(a%60,2);return r+n+t+c}const lt=(s,t)=>{switch(s){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},wt=(s,t)=>{switch(s){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},ds=(s,t)=>{const r=s.match(/(P+)(p+)?/)||[],a=r[1],n=r[2];if(!n)return lt(s,t);let c;switch(a){case"P":c=t.dateTime({width:"short"});break;case"PP":c=t.dateTime({width:"medium"});break;case"PPP":c=t.dateTime({width:"long"});break;case"PPPP":default:c=t.dateTime({width:"full"});break}return c.replace("{{date}}",lt(a,t)).replace("{{time}}",wt(n,t))},ms={p:wt,P:ds},us=/^D+$/,xs=/^Y+$/,hs=["D","DD","YY","YYYY"];function fs(s){return us.test(s)}function gs(s){return xs.test(s)}function ps(s,t,r){const a=js(s,t,r);if(console.warn(a),hs.includes(s))throw new RangeError(a)}function js(s,t,r){const a=s[0]==="Y"?"years":"days of the month";return`Use \`${s.toLowerCase()}\` instead of \`${s}\` (in \`${t}\`) for formatting ${a} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const ys=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,bs=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ns=/^'([^]*?)'?$/,vs=/''/g,ws=/[a-zA-Z]/;function Ss(s,t,r){var f,h,u,O;const a=_e(),n=a.locale??At,c=a.firstWeekContainsDate??((h=(f=a.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,i=a.weekStartsOn??((O=(u=a.locale)==null?void 0:u.options)==null?void 0:O.weekStartsOn)??0,l=G(s);if(!as(l))throw new RangeError("Invalid time value");let d=t.match(bs).map(g=>{const o=g[0];if(o==="p"||o==="P"){const m=ms[o];return m(g,n.formatLong)}return g}).join("").match(ys).map(g=>{if(g==="''")return{isToken:!1,value:"'"};const o=g[0];if(o==="'")return{isToken:!1,value:Ps(g)};if(nt[o])return{isToken:!0,value:g};if(o.match(ws))throw new RangeError("Format string contains an unescaped latin alphabet character `"+o+"`");return{isToken:!1,value:g}});n.localize.preprocessor&&(d=n.localize.preprocessor(l,d));const p={firstWeekContainsDate:c,weekStartsOn:i,locale:n};return d.map(g=>{if(!g.isToken)return g.value;const o=g.value;(gs(o)||fs(o))&&ps(o,t,String(s));const m=nt[o[0]];return m(l,o,n.localize,p)}).join("")}function Ps(s){const t=s.match(Ns);return t?t[1].replace(vs,"'"):s}var Os=["cx","cy","innerRadius","outerRadius","gridType","radialLines"];function de(s){"@babel/helpers - typeof";return de=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},de(s)}function Cs(s,t){if(s==null)return{};var r=As(s,t),a,n;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(s);for(n=0;n<c.length;n++)a=c[n],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(s,a)&&(r[a]=s[a])}return r}function As(s,t){if(s==null)return{};var r={};for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a)){if(t.indexOf(a)>=0)continue;r[a]=s[a]}return r}function K(){return K=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(s[a]=r[a])}return s},K.apply(this,arguments)}function ot(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),r.push.apply(r,a)}return r}function me(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ot(Object(r),!0).forEach(function(a){Ts(s,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):ot(Object(r)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(r,a))})}return s}function Ts(s,t,r){return t=_s(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function _s(s){var t=Es(s,"string");return de(t)=="symbol"?t:t+""}function Es(s,t){if(de(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var a=r.call(s,t);if(de(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var Ds=function(t,r,a,n){var c="";return n.forEach(function(i,l){var d=le(r,a,t,i);l?c+="L ".concat(d.x,",").concat(d.y):c+="M ".concat(d.x,",").concat(d.y)}),c+="Z",c},Ms=function(t){var r=t.cx,a=t.cy,n=t.innerRadius,c=t.outerRadius,i=t.polarAngles,l=t.radialLines;if(!i||!i.length||!l)return null;var d=me({stroke:"#ccc"},se(t,!1));return D.createElement("g",{className:"recharts-polar-grid-angle"},i.map(function(p){var f=le(r,a,n,p),h=le(r,a,c,p);return D.createElement("line",K({},d,{key:"line-".concat(p),x1:f.x,y1:f.y,x2:h.x,y2:h.y}))}))},Rs=function(t){var r=t.cx,a=t.cy,n=t.radius,c=t.index,i=me(me({stroke:"#ccc"},se(t,!1)),{},{fill:"none"});return D.createElement("circle",K({},i,{className:ve("recharts-polar-grid-concentric-circle",t.className),key:"circle-".concat(c),cx:r,cy:a,r:n}))},ks=function(t){var r=t.radius,a=t.index,n=me(me({stroke:"#ccc"},se(t,!1)),{},{fill:"none"});return D.createElement("path",K({},n,{className:ve("recharts-polar-grid-concentric-polygon",t.className),key:"path-".concat(a),d:Ds(r,t.cx,t.cy,t.polarAngles)}))},Fs=function(t){var r=t.polarRadius,a=t.gridType;return!r||!r.length?null:D.createElement("g",{className:"recharts-polar-grid-concentric"},r.map(function(n,c){var i=c;return a==="circle"?D.createElement(Rs,K({key:i},t,{radius:n,index:c})):D.createElement(ks,K({key:i},t,{radius:n,index:c}))}))},St=function(t){var r=t.cx,a=r===void 0?0:r,n=t.cy,c=n===void 0?0:n,i=t.innerRadius,l=i===void 0?0:i,d=t.outerRadius,p=d===void 0?0:d,f=t.gridType,h=f===void 0?"polygon":f,u=t.radialLines,O=u===void 0?!0:u,g=Cs(t,Os);return p<=0?null:D.createElement("g",{className:"recharts-polar-grid"},D.createElement(Ms,K({cx:a,cy:c,innerRadius:l,outerRadius:p,gridType:h,radialLines:O},g)),D.createElement(Fs,K({cx:a,cy:c,innerRadius:l,outerRadius:p,gridType:h,radialLines:O},g)))};St.displayName="PolarGrid";function $s(s){return s&&s.length?s[0]:void 0}var Ls=$s,Is=Ls;const Ys=Tt(Is);var Ws=["key"];function ae(s){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(s)}function qs(s,t){if(s==null)return{};var r=Bs(s,t),a,n;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(s);for(n=0;n<c.length;n++)a=c[n],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(s,a)&&(r[a]=s[a])}return r}function Bs(s,t){if(s==null)return{};var r={};for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a)){if(t.indexOf(a)>=0)continue;r[a]=s[a]}return r}function Ae(){return Ae=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(s[a]=r[a])}return s},Ae.apply(this,arguments)}function dt(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),r.push.apply(r,a)}return r}function L(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dt(Object(r),!0).forEach(function(a){H(s,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):dt(Object(r)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(r,a))})}return s}function Gs(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function mt(s,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(s,Ot(a.key),a)}}function Hs(s,t,r){return t&&mt(s.prototype,t),r&&mt(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function zs(s,t,r){return t=Te(t),Ks(s,Pt()?Reflect.construct(t,r||[],Te(s).constructor):t.apply(s,r))}function Ks(s,t){if(t&&(ae(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vs(s)}function Vs(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Pt(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pt=function(){return!!s})()}function Te(s){return Te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Te(s)}function Qs(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&We(s,t)}function We(s,t){return We=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,n){return a.__proto__=n,a},We(s,t)}function H(s,t,r){return t=Ot(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function Ot(s){var t=Xs(s,"string");return ae(t)=="symbol"?t:t+""}function Xs(s,t){if(ae(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var a=r.call(s,t);if(ae(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var xe=function(s){function t(){var r;Gs(this,t);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return r=zs(this,t,[].concat(n)),H(r,"state",{isAnimationFinished:!1}),H(r,"handleAnimationEnd",function(){var i=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),pe(i)&&i()}),H(r,"handleAnimationStart",function(){var i=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),pe(i)&&i()}),H(r,"handleMouseEnter",function(i){var l=r.props.onMouseEnter;l&&l(r.props,i)}),H(r,"handleMouseLeave",function(i){var l=r.props.onMouseLeave;l&&l(r.props,i)}),r}return Qs(t,s),Hs(t,[{key:"renderDots",value:function(a){var n=this.props,c=n.dot,i=n.dataKey,l=se(this.props,!1),d=se(c,!0),p=a.map(function(f,h){var u=L(L(L({key:"dot-".concat(h),r:3},l),d),{},{dataKey:i,cx:f.x,cy:f.y,index:h,payload:f});return t.renderDotItem(c,u)});return D.createElement(ke,{className:"recharts-radar-dots"},p)}},{key:"renderPolygonStatically",value:function(a){var n=this.props,c=n.shape,i=n.dot,l=n.isRange,d=n.baseLinePoints,p=n.connectNulls,f;return D.isValidElement(c)?f=D.cloneElement(c,L(L({},this.props),{},{points:a})):pe(c)?f=c(L(L({},this.props),{},{points:a})):f=D.createElement(Ht,Ae({},se(this.props,!0),{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,points:a,baseLinePoints:l?d:null,connectNulls:p})),D.createElement(ke,{className:"recharts-radar-polygon"},f,i?this.renderDots(a):null)}},{key:"renderPolygonWithAnimation",value:function(){var a=this,n=this.props,c=n.points,i=n.isAnimationActive,l=n.animationBegin,d=n.animationDuration,p=n.animationEasing,f=n.animationId,h=this.state.prevPoints;return D.createElement(Lt,{begin:l,duration:d,isActive:i,easing:p,from:{t:0},to:{t:1},key:"radar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(u){var O=u.t,g=h&&h.length/c.length,o=c.map(function(m,_){var A=h&&h[Math.floor(_*g)];if(A){var B=je(A.x,m.x),b=je(A.y,m.y);return L(L({},m),{},{x:B(O),y:b(O)})}var j=je(m.cx,m.x),E=je(m.cy,m.y);return L(L({},m),{},{x:j(O),y:E(O)})});return a.renderPolygonStatically(o)})}},{key:"renderPolygon",value:function(){var a=this.props,n=a.points,c=a.isAnimationActive,i=a.isRange,l=this.state.prevPoints;return c&&n&&n.length&&!i&&(!l||!It(l,n))?this.renderPolygonWithAnimation():this.renderPolygonStatically(n)}},{key:"render",value:function(){var a=this.props,n=a.hide,c=a.className,i=a.points,l=a.isAnimationActive;if(n||!i||!i.length)return null;var d=this.state.isAnimationFinished,p=ve("recharts-radar",c);return D.createElement(ke,{className:p},this.renderPolygon(),(!l||d)&&Yt.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(a,n){return a.animationId!==n.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,prevPoints:n.curPoints}:a.points!==n.curPoints?{curPoints:a.points}:null}},{key:"renderDotItem",value:function(a,n){var c;if(D.isValidElement(a))c=D.cloneElement(a,n);else if(pe(a))c=a(n);else{var i=n.key,l=qs(n,Ws);c=D.createElement($t,Ae({},l,{key:i,className:ve("recharts-radar-dot",typeof a!="boolean"?a.className:"")}))}return c}}])}(y.PureComponent);H(xe,"displayName","Radar");H(xe,"defaultProps",{angleAxisId:0,radiusAxisId:0,hide:!1,activeDot:!0,dot:!1,legendType:"rect",isAnimationActive:!Wt.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});H(xe,"getComposedData",function(s){var t=s.radiusAxis,r=s.angleAxis,a=s.displayedData,n=s.dataKey,c=s.bandSize,i=r.cx,l=r.cy,d=!1,p=[],f=r.type!=="number"?c??0:0;a.forEach(function(u,O){var g=st(u,r.dataKey,O),o=st(u,n),m=r.scale(g)+f,_=Array.isArray(o)?qt(o):o,A=rt(_)?void 0:t.scale(_);Array.isArray(o)&&o.length>=2&&(d=!0),p.push(L(L({},le(i,l,A,m)),{},{name:g,value:o,cx:i,cy:l,radius:A,angle:m,payload:u}))});var h=[];return d&&p.forEach(function(u){if(Array.isArray(u.value)){var O=Ys(u.value),g=rt(O)?void 0:t.scale(O);h.push(L(L({},u),{},{radius:g},le(i,l,g,u.angle)))}else h.push(u)}),{points:p,isRange:d,baseLinePoints:h}});var Us=Bt({chartName:"RadarChart",GraphicalChild:xe,axisComponents:[{axisType:"angleAxis",AxisComp:jt},{axisType:"radiusAxis",AxisComp:yt}],formatAxisMap:Gt,defaultProps:{layout:"centric",startAngle:90,endAngle:-270,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const ut=["#8b5cf6","#06b6d4","#10b981","#f59e0b","#ef4444","#ec4899","#6366f1","#84cc16"],Zs=({data:s,columns:t,numericColumns:r,categoricalColumns:a,columnTypes:n,datasetName:c,onModelTrained:i})=>{const[l,d]=y.useState(""),[p,f]=y.useState(!1),[h,u]=y.useState(null),[O,g]=y.useState(""),[o,m]=y.useState(null),_=y.useMemo(()=>l?n[l]==="categorical"||new Set(s.map(j=>j[l])).size<=10?"classification":"regression":null,[l,n,s]),A=y.useMemo(()=>t.filter(b=>b!==l),[t,l]),B=y.useCallback(async()=>{var b,j,E;if(!l||!_){I.error("Please select a target column");return}f(!0),u({stage:"Connecting",progress:10,message:"Connecting to ML server..."});try{u({stage:"Uploading",progress:25,message:"Uploading data for training..."});const S=await Ge.trainPredictionModel(s,l,r.filter($=>$!==l),"auto");if(u({stage:"Training",progress:60,message:"Training Random Forest model..."}),!S.success||!S.data)throw new Error(S.error||"Training failed");const P=S.data;u({stage:"Evaluating",progress:80,message:"Evaluating model performance..."});let x="";try{u({stage:"Explaining",progress:90,message:"Generating AI explanation..."});const $=await Se.explainAnalysis("prediction_model",{model_type:P.model_type,target:l,metrics:P.metrics,top_features:P.feature_importance.slice(0,3)},`Dataset: ${c}, ${s.length} rows`);$.success&&$.data&&(x=$.data.explanation)}catch{x=P.model_type==="classification"?`The Random Forest classifier achieved ${((P.metrics.accuracy||0)*100).toFixed(1)}% accuracy with ${((P.metrics.cv_accuracy||0)*100).toFixed(1)}% cross-validation accuracy. ${(b=P.feature_importance[0])==null?void 0:b.feature} is the most important predictor.`:`The Random Forest regressor achieved an R² score of ${((j=P.metrics.r2_score)==null?void 0:j.toFixed(3))||"N/A"}. ${(E=P.feature_importance[0])==null?void 0:E.feature} has the strongest influence on predictions.`}g(x),u({stage:"Complete",progress:100,message:"Model trained successfully!"});const v={type:P.model_type,accuracy:P.model_type==="classification"?P.metrics.accuracy:void 0,rSquared:P.model_type==="regression"?P.metrics.r2_score:void 0,metrics:P.metrics,featureImportance:P.feature_importance,explanation:x,predictions:P.sample_predictions};m(v);const M={id:`pred-${Date.now()}`,name:`Random Forest ${P.model_type==="classification"?"Classifier":"Regressor"}`,type:P.model_type,accuracy:v.accuracy,rSquared:v.rSquared,featureImportance:P.feature_importance,trainedAt:new Date,status:"ready",explanation:x};i(M),I.success("Model trained successfully using server-side ML!")}catch(S){console.error("Training error:",S),I.error(S instanceof Error?S.message:"Model training failed"),u(null)}finally{f(!1)}},[l,_,s,r,c,i]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(N,{children:[e.jsxs(k,{children:[e.jsxs(F,{className:"text-lg flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5 text-primary"}),"Server-Side Prediction Model",e.jsxs(T,{variant:"secondary",className:"text-xs bg-green-500/10 text-green-500 border-green-500/30",children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),"Backend ML"]})]}),e.jsx(q,{children:"Train production-grade Random Forest models using scikit-learn on the server"})]}),e.jsxs(w,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ne,{children:"Target Column (What to predict)"}),e.jsxs($e,{value:l,onValueChange:d,children:[e.jsx(Le,{children:e.jsx(Ie,{placeholder:"Select target column"})}),e.jsx(Ye,{children:t.map(b=>e.jsx(be,{value:b,children:e.jsxs("div",{className:"flex items-center gap-2",children:[b,e.jsx(T,{variant:"outline",className:"text-xs",children:n[b]})]})},b))})]})]}),l&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(ne,{children:"Detected Model Type"}),e.jsx("div",{className:"flex items-center gap-2 h-10 px-3 border rounded-md bg-muted/50",children:_==="classification"?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"bg-blue-500/10 text-blue-500",children:"Classification"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Predicts categories"})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"bg-green-500/10 text-green-500",children:"Regression"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Predicts numbers"})]})})]})]}),l&&e.jsxs("div",{className:"bg-gradient-to-br from-primary/5 to-accent/5 rounded-lg p-4 space-y-3 border border-primary/20",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Be,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-medium",children:"Server-Side Training Configuration"})]}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 ml-6",children:[e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"Algorithm:"})," Random Forest (100 trees, scikit-learn)"]}),e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"Features:"})," ",A.filter(b=>n[b]==="numeric").length," numeric columns"]}),e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"Validation:"})," 5-fold cross-validation"]}),e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"Training samples:"})," ",s.length," rows"]}),e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"AI Explanation:"})," GPT-5.2 powered insights"]})]})]}),e.jsx(Ee,{onClick:B,disabled:!l||p,className:"w-full sm:w-auto bg-gradient-to-r from-primary to-accent",children:p?e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}),"Training on Server..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ht,{className:"h-4 w-4 mr-2"}),"Train Model (Server-Side ML)"]})})]})]}),h&&p&&e.jsx(N,{className:"border-primary/30",children:e.jsx(w,{className:"py-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-primary animate-pulse"}),h.stage]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h.progress,"%"]})]}),e.jsx(we,{value:h.progress,className:"h-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h.message})]})})}),o&&!p&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(N,{className:"bg-gradient-to-br from-green-500/10 to-transparent border-green-500/30",children:e.jsx(w,{className:"py-6",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-green-500/20",children:e.jsx(Me,{className:"h-8 w-8 text-green-500"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:["Model Trained Successfully",e.jsxs(T,{variant:"outline",className:"text-xs bg-primary/10 text-primary",children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),"Server ML"]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Random Forest ",o.type==="classification"?"Classifier":"Regressor"," (scikit-learn)"]})]})]}),e.jsx("div",{className:"text-right",children:o.type==="classification"?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-3xl font-bold text-green-500",children:[((o.accuracy||0)*100).toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Accuracy"}),o.metrics.cv_accuracy&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["CV: ",(o.metrics.cv_accuracy*100).toFixed(1),"% ± ",((o.metrics.cv_std||0)*100).toFixed(1),"%"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-3xl font-bold text-green-500",children:(o.rSquared||0).toFixed(3)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"R² Score"}),o.metrics.rmse&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["RMSE: ",o.metrics.rmse.toFixed(4)]})]})})]})})}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:Object.entries(o.metrics).map(([b,j])=>e.jsx(N,{className:"bg-card/50",children:e.jsxs(w,{className:"pt-4",children:[e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:b.replace(/_/g," ")}),e.jsx("p",{className:"text-xl font-bold mt-1",children:typeof j=="number"?b.includes("accuracy")||b.includes("precision")||b.includes("recall")||b.includes("f1")?`${(j*100).toFixed(1)}%`:j.toFixed(4):j})]})},b))}),e.jsxs(N,{children:[e.jsxs(k,{children:[e.jsxs(F,{className:"text-lg flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5 text-primary"}),"Feature Importance"]}),e.jsx(q,{children:"Which features have the most influence on predictions"})]}),e.jsx(w,{children:e.jsx("div",{className:"h-64",children:e.jsx(Pe,{width:"100%",height:"100%",children:e.jsxs(bt,{data:o.featureImportance.slice(0,8),layout:"vertical",margin:{left:20,right:20},children:[e.jsx(He,{strokeDasharray:"3 3",opacity:.3}),e.jsx(ze,{type:"number",domain:[0,"auto"],tickFormatter:b=>`${(b*100).toFixed(0)}%`}),e.jsx(Ke,{type:"category",dataKey:"feature",width:100,tick:{fontSize:12}}),e.jsx(Ve,{formatter:b=>[`${(b*100).toFixed(1)}%`,"Importance"],contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(ft,{dataKey:"importance",radius:[0,4,4,0],children:o.featureImportance.slice(0,8).map((b,j)=>e.jsx(gt,{fill:ut[j%ut.length]},`cell-${j}`))})]})})})})]}),e.jsxs(N,{className:"bg-gradient-to-br from-purple-500/10 to-transparent border-purple-500/30",children:[e.jsx(k,{children:e.jsxs(F,{className:"text-lg flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5 text-yellow-500"}),"AI-Powered Explanation",e.jsxs(T,{variant:"secondary",className:"text-xs bg-purple-500/10 text-purple-500",children:[e.jsx(Re,{className:"h-3 w-3 mr-1"}),"GPT-5.2"]})]})}),e.jsx(w,{children:e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:o.explanation||O||"The model has been trained successfully. Feature importance shows which variables are most predictive."})})]}),o.predictions&&o.predictions.length>0&&e.jsxs(N,{children:[e.jsxs(k,{children:[e.jsx(F,{className:"text-lg",children:"Sample Predictions"}),e.jsx(q,{children:"Comparison of actual vs predicted values"})]}),e.jsx(w,{children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:o.predictions.slice(0,10).map((b,j)=>e.jsxs("div",{className:"p-2 rounded-lg bg-muted/30 text-center",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Actual"}),e.jsx("p",{className:"font-medium text-sm",children:String(b.actual)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Predicted"}),e.jsx("p",{className:`font-medium text-sm ${b.actual===b.predicted?"text-green-500":"text-orange-500"}`,children:String(b.predicted)})]},j))})})]})]})]})},te=["#8b5cf6","#06b6d4","#10b981","#f59e0b","#ef4444","#ec4899","#6366f1","#84cc16"],Js=({data:s,columns:t,numericColumns:r,columnTypes:a,datasetName:n,onModelTrained:c})=>{const[i,l]=y.useState("kmeans"),[d,p]=y.useState(!0),[f,h]=y.useState(3),[u,O]=y.useState(!1),[g,o]=y.useState(null),[m,_]=y.useState(""),[A,B]=y.useState(null),b=y.useCallback(async()=>{var j;if(r.length<2){I.error("Need at least 2 numeric columns for clustering");return}O(!0),o({stage:"Connecting",progress:10,message:"Connecting to ML server..."});try{o({stage:"Uploading",progress:25,message:"Uploading data for clustering..."});const E=await Ge.performClustering(s,r.slice(0,10),d?void 0:f,i);if(o({stage:"Clustering",progress:60,message:`Running ${i.toUpperCase()} clustering...`}),!E.success||!E.data)throw new Error(E.error||"Clustering failed");const S=E.data;o({stage:"Analyzing",progress:80,message:"Analyzing cluster characteristics..."});const P=S.cluster_stats.map((v,M)=>({id:v.cluster_id,name:`Cluster ${v.cluster_id+1}`,count:v.size,percentage:v.percentage,centroid:v.centroid,characteristics:"",recommendation:""}));try{o({stage:"AI Analysis",progress:90,message:"Generating AI insights for clusters..."});const v=await Se.explainAnalysis("clustering",{n_clusters:S.n_clusters,silhouette_score:S.metrics.silhouette_score,cluster_stats:S.cluster_stats},`Dataset: ${n}, ${s.length} rows`);v.success&&v.data&&_(v.data.explanation);const M=await Se.generateRecommendations(s.slice(0,100),r.slice(0,5),{clusters:S.cluster_stats},"Customer segmentation analysis");if(M.success&&((j=M.data)!=null&&j.recommendations)){const $=M.data.recommendations;$.immediate_actions&&P.forEach((R,V)=>{$.immediate_actions&&$.immediate_actions[V]&&(R.recommendation=$.immediate_actions[V])})}}catch{const v=["Value Seekers","Premium Customers","Casual Browsers","Power Users","New Adopters","Loyal Base"];P.forEach((M,$)=>{M.name=v[$]||`Segment ${$+1}`,M.recommendation="Focus on personalized engagement strategies for this segment."})}o({stage:"Complete",progress:100,message:"Clustering complete!"}),B({clusters:P,scatterData:S.scatter_data,xAxis:S.x_axis,yAxis:S.y_axis,silhouetteScore:S.metrics.silhouette_score,calinskiScore:S.metrics.calinski_harabasz_score});const x={id:`cluster-${Date.now()}`,name:`${i.toUpperCase()} (${S.n_clusters} clusters)`,type:"clustering",clusters:S.n_clusters,trainedAt:new Date,status:"ready",explanation:`Identified ${S.n_clusters} distinct segments with silhouette score of ${S.metrics.silhouette_score.toFixed(2)}`};c(x),I.success(`Found ${S.n_clusters} clusters using server-side ML!`)}catch(E){console.error("Clustering error:",E),I.error(E instanceof Error?E.message:"Clustering failed")}finally{O(!1)}},[s,r,f,d,i,n,c]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(N,{children:[e.jsxs(k,{children:[e.jsxs(F,{className:"text-lg flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5 text-primary"}),"Server-Side Clustering Analysis",e.jsxs(T,{variant:"secondary",className:"text-xs bg-green-500/10 text-green-500 border-green-500/30",children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),"Backend ML"]})]}),e.jsx(q,{children:"Automatically discover segments and patterns using scikit-learn on the server"})]}),e.jsxs(w,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ne,{children:"Algorithm"}),e.jsxs($e,{value:i,onValueChange:j=>l(j),children:[e.jsx(Le,{children:e.jsx(Ie,{})}),e.jsxs(Ye,{children:[e.jsx(be,{value:"kmeans",children:"K-Means Clustering"}),e.jsx(be,{value:"dbscan",children:"DBSCAN (Density-based)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ne,{children:"Auto-detect clusters (Elbow Method)"}),e.jsx(Vt,{checked:d,onCheckedChange:p})]}),!d&&e.jsxs($e,{value:String(f),onValueChange:j=>h(Number(j)),children:[e.jsx(Le,{children:e.jsx(Ie,{})}),e.jsx(Ye,{children:[2,3,4,5,6,7,8].map(j=>e.jsxs(be,{value:String(j),children:[j," clusters"]},j))})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-primary/5 to-accent/5 rounded-lg p-4 space-y-2 border border-primary/20",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Be,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-medium",children:"Server-Side Processing"})]}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 ml-6",children:[e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"Algorithm:"})," scikit-learn ",i==="kmeans"?"KMeans":"DBSCAN"]}),e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"Features:"})," ",r.slice(0,10).length," numeric columns"]}),e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"Optimization:"})," Silhouette & Calinski-Harabasz scores"]}),e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"AI Insights:"})," GPT-5.2 powered explanations"]})]})]}),e.jsx(Ee,{onClick:b,disabled:u||r.length<2,className:"w-full sm:w-auto bg-gradient-to-r from-primary to-accent",children:u?e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}),"Clustering on Server..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ht,{className:"h-4 w-4 mr-2"}),"Run Clustering (Server-Side ML)"]})})]})]}),g&&u&&e.jsx(N,{className:"border-primary/30",children:e.jsx(w,{className:"py-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-primary animate-pulse"}),g.stage]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[g.progress,"%"]})]}),e.jsx(we,{value:g.progress,className:"h-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:g.message})]})})}),A&&!u&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(N,{className:"bg-gradient-to-br from-blue-500/10 to-transparent border-blue-500/30",children:e.jsx(w,{className:"py-6",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-blue-500/20",children:e.jsx(Me,{className:"h-8 w-8 text-blue-500"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:["Clustering Complete",e.jsxs(T,{variant:"outline",className:"text-xs bg-primary/10 text-primary",children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),"Server ML"]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Found ",A.clusters.length," distinct segments"]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-500",children:A.silhouetteScore.toFixed(2)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Silhouette Score"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-500",children:A.calinskiScore.toFixed(0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Calinski-Harabasz"})]})]})]})})}),m&&e.jsxs(N,{className:"bg-gradient-to-br from-purple-500/10 to-transparent border-purple-500/30",children:[e.jsx(k,{className:"pb-2",children:e.jsxs(F,{className:"text-base flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-yellow-500"}),"AI Analysis",e.jsxs(T,{variant:"secondary",className:"text-xs bg-purple-500/10 text-purple-500",children:[e.jsx(Re,{className:"h-3 w-3 mr-1"}),"GPT-5.2"]})]})}),e.jsx(w,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:m})})]}),e.jsxs(N,{children:[e.jsxs(k,{children:[e.jsx(F,{className:"text-lg",children:"Cluster Visualization (2D)"}),e.jsxs(q,{children:[A.xAxis," vs ",A.yAxis]})]}),e.jsx(w,{children:e.jsx("div",{className:"h-80",children:e.jsx(Pe,{width:"100%",height:"100%",children:e.jsxs(zt,{margin:{top:20,right:20,bottom:20,left:20},children:[e.jsx(He,{strokeDasharray:"3 3",opacity:.3}),e.jsx(ze,{type:"number",dataKey:"x",name:A.xAxis,tick:{fontSize:12}}),e.jsx(Ke,{type:"number",dataKey:"y",name:A.yAxis,tick:{fontSize:12}}),e.jsx(Ve,{cursor:{strokeDasharray:"3 3"},contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(pt,{}),A.clusters.map((j,E)=>e.jsx(Kt,{name:j.name,data:A.scatterData.filter(S=>S.cluster===j.id).slice(0,200),fill:te[E%te.length]},j.id))]})})})})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:A.clusters.map((j,E)=>e.jsxs(N,{className:"border-l-4",style:{borderLeftColor:te[E%te.length]},children:[e.jsxs(k,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(F,{className:"text-base flex items-center gap-2",children:[e.jsx(_t,{className:"h-4 w-4",style:{color:te[E%te.length]}}),j.name]}),e.jsxs(T,{variant:"secondary",children:[j.count," members"]})]}),e.jsxs(q,{children:[j.percentage.toFixed(1),"% of data"]})]}),e.jsxs(w,{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium mb-1",children:"Key Characteristics:"}),e.jsx("div",{className:"text-xs text-muted-foreground space-y-1",children:Object.entries(j.centroid).slice(0,3).map(([S,P])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[S,":"]}),e.jsx("span",{className:"font-mono",children:P.toFixed(2)})]},S))})]}),j.recommendation&&e.jsx("div",{className:"bg-muted/30 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-yellow-500 mt-0.5 shrink-0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:j.recommendation})]})})]})]},j.id))})]})]})},Qe=y.forwardRef(({className:s,...t},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:X("w-full caption-bottom text-sm",s),...t})}));Qe.displayName="Table";const Xe=y.forwardRef(({className:s,...t},r)=>e.jsx("thead",{ref:r,className:X("[&_tr]:border-b",s),...t}));Xe.displayName="TableHeader";const Ue=y.forwardRef(({className:s,...t},r)=>e.jsx("tbody",{ref:r,className:X("[&_tr:last-child]:border-0",s),...t}));Ue.displayName="TableBody";const er=y.forwardRef(({className:s,...t},r)=>e.jsx("tfoot",{ref:r,className:X("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t}));er.displayName="TableFooter";const ue=y.forwardRef(({className:s,...t},r)=>e.jsx("tr",{ref:r,className:X("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",s),...t}));ue.displayName="TableRow";const Y=y.forwardRef(({className:s,...t},r)=>e.jsx("th",{ref:r,className:X("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t}));Y.displayName="TableHead";const W=y.forwardRef(({className:s,...t},r)=>e.jsx("td",{ref:r,className:X("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t}));W.displayName="TableCell";const tr=y.forwardRef(({className:s,...t},r)=>e.jsx("caption",{ref:r,className:X("mt-4 text-sm text-muted-foreground",s),...t}));tr.displayName="TableCaption";const sr=({data:s,columns:t,numericColumns:r,columnTypes:a,datasetName:n,onModelTrained:c})=>{const[i,l]=y.useState(!1),[d,p]=y.useState(.1),[f,h]=y.useState(null),[u,O]=y.useState([]),[g,o]=y.useState(null),[m,_]=y.useState({}),[A,B]=y.useState(""),[b,j]=y.useState(0),E=y.useCallback(async()=>{if(r.length===0){I.error("Need numeric columns for anomaly detection");return}l(!0),h({stage:"Connecting",progress:10,message:"Connecting to ML server..."});try{h({stage:"Uploading",progress:25,message:"Uploading data for analysis..."});const x=await Ge.detectAnomalies(s,r.slice(0,10),d);if(h({stage:"Detecting",progress:60,message:"Running Isolation Forest algorithm..."}),!x.success||!x.data)throw new Error(x.error||"Anomaly detection failed");const v=x.data;h({stage:"Analyzing",progress:80,message:"Analyzing detected anomalies..."});const M=v.anomalies.map(R=>{const V=R.affected_columns.slice(0,3);let Ze=`Row ${R.index+1} shows unusual values. `;V.forEach(Je=>{Ze+=`${Je.column} is ${Je.z_score.toFixed(1)} standard deviations from mean. `});let he="Review this data point for potential errors.";return R.severity==="critical"?he="Investigate immediately - this may indicate a data quality issue or significant event.":R.severity==="high"?he="Verify this data entry and correct if necessary.":R.severity==="medium"&&(he="Flag for review during next data quality check."),{index:R.index,row:R.row_data,score:R.anomaly_score,severity:R.severity,affectedColumns:R.affected_columns,explanation:Ze,suggestedAction:he}});try{h({stage:"AI Analysis",progress:90,message:"Generating AI insights..."});const R=await Se.explainAnalysis("anomaly_detection",{total_anomalies:v.anomaly_count,anomaly_rate:v.anomaly_rate,severity_breakdown:v.severity_summary,sample_anomalies:M.slice(0,5).map(V=>({index:V.index,severity:V.severity,top_deviations:V.affectedColumns.slice(0,2)}))},`Dataset: ${n}, ${s.length} rows, Contamination: ${d}`);R.success&&R.data&&B(R.data.explanation)}catch{B(`Detected ${v.anomaly_count} anomalies (${v.anomaly_rate.toFixed(1)}% of data) using Isolation Forest algorithm.`)}h({stage:"Complete",progress:100,message:"Detection complete!"}),O(M),_(v.severity_summary),j(v.total_records);const $={id:`anomaly-${Date.now()}`,name:"Isolation Forest Detector",type:"anomaly",anomalyCount:v.anomaly_count,trainedAt:new Date,status:"ready",explanation:`Detected ${v.anomaly_count} anomalies (${v.anomaly_rate.toFixed(1)}% of data)`};c($),I.success(`Found ${v.anomaly_count} anomalies using server-side ML!`)}catch(x){console.error("Detection error:",x),I.error(x instanceof Error?x.message:"Anomaly detection failed")}finally{l(!1)}},[s,r,d,n,c]),S=x=>{switch(x){case"critical":return"bg-red-500/10 text-red-500 border-red-500/30";case"high":return"bg-orange-500/10 text-orange-500 border-orange-500/30";case"medium":return"bg-yellow-500/10 text-yellow-500 border-yellow-500/30";case"low":return"bg-blue-500/10 text-blue-500 border-blue-500/30"}},P=x=>{switch(x){case"critical":return e.jsx(Ne,{className:"h-4 w-4"});case"high":return e.jsx(Z,{className:"h-4 w-4"});case"medium":return e.jsx(re,{className:"h-4 w-4"});case"low":return e.jsx(Xt,{className:"h-4 w-4"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(N,{children:[e.jsxs(k,{children:[e.jsxs(F,{className:"text-lg flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-primary"}),"Server-Side Anomaly Detection",e.jsxs(T,{variant:"secondary",className:"text-xs bg-green-500/10 text-green-500 border-green-500/30",children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),"Backend ML"]})]}),e.jsx(q,{children:"Find unusual data points using Isolation Forest algorithm on the server"})]}),e.jsxs(w,{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ne,{children:"Contamination Rate (Expected anomaly %)"}),e.jsxs("span",{className:"text-sm font-medium",children:[(d*100).toFixed(0),"%"]})]}),e.jsx(Qt,{value:[d*100],onValueChange:x=>p(x[0]/100),min:1,max:30,step:1,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Higher values detect more anomalies, lower values are more strict"})]})}),e.jsxs("div",{className:"bg-gradient-to-br from-primary/5 to-accent/5 rounded-lg p-4 space-y-2 border border-primary/20",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Be,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-medium",children:"Server-Side Detection Methods"})]}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 ml-6",children:[e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"Algorithm:"})," Isolation Forest (scikit-learn)"]}),e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"Features:"})," ",r.slice(0,10).length," numeric columns"]}),e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"Scoring:"})," Z-score & IQR-based severity"]}),e.jsxs("li",{children:["• ",e.jsx("span",{className:"text-primary font-medium",children:"AI Insights:"})," GPT-5.2 powered explanations"]})]})]}),e.jsx(Ee,{onClick:E,disabled:i||r.length===0,className:"w-full sm:w-auto bg-gradient-to-r from-primary to-accent",children:i?e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}),"Detecting on Server..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Et,{className:"h-4 w-4 mr-2"}),"Detect Anomalies (Server-Side ML)"]})})]})]}),f&&i&&e.jsx(N,{className:"border-primary/30",children:e.jsx(w,{className:"py-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-primary animate-pulse"}),f.stage]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[f.progress,"%"]})]}),e.jsx(we,{value:f.progress,className:"h-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.message})]})})}),u.length>0&&!i&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-4",children:[e.jsx(N,{className:"bg-card/50 col-span-1",children:e.jsxs(w,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Total"})]}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:u.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(u.length/b*100).toFixed(1),"% of data"]})]})}),["critical","high","medium","low"].map(x=>{const v=m[x]||0;return e.jsx(N,{className:`${S(x)} border`,children:e.jsxs(w,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[P(x),e.jsx("span",{className:"text-sm font-medium capitalize",children:x})]}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:v})]})},x)})]}),A&&e.jsxs(N,{className:"bg-gradient-to-br from-purple-500/10 to-transparent border-purple-500/30",children:[e.jsx(k,{className:"pb-2",children:e.jsxs(F,{className:"text-base flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-yellow-500"}),"AI Analysis",e.jsxs(T,{variant:"secondary",className:"text-xs bg-purple-500/10 text-purple-500",children:[e.jsx(Re,{className:"h-3 w-3 mr-1"}),"GPT-5.2"]})]})}),e.jsx(w,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:A})})]}),e.jsxs(N,{children:[e.jsxs(k,{children:[e.jsxs(F,{className:"text-lg flex items-center gap-2",children:["Detected Anomalies",e.jsxs(T,{variant:"outline",className:"text-xs bg-primary/10 text-primary",children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),"Isolation Forest"]})]}),e.jsxs(q,{children:["Top ",u.length," unusual data points ranked by severity"]})]}),e.jsx(w,{children:e.jsx(Fe,{className:"h-96",children:e.jsxs(Qe,{children:[e.jsx(Xe,{children:e.jsxs(ue,{children:[e.jsx(Y,{className:"w-16",children:"Row"}),e.jsx(Y,{className:"w-24",children:"Severity"}),e.jsx(Y,{children:"Affected Columns"}),e.jsx(Y,{children:"Explanation"}),e.jsx(Y,{className:"w-24",children:"Score"})]})}),e.jsx(Ue,{children:u.map((x,v)=>e.jsxs(ue,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>o(x),children:[e.jsx(W,{className:"font-mono",children:x.index+1}),e.jsx(W,{children:e.jsxs(T,{className:S(x.severity),children:[P(x.severity),e.jsx("span",{className:"ml-1 capitalize",children:x.severity})]})}),e.jsx(W,{children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[x.affectedColumns.slice(0,3).map(M=>e.jsxs(T,{variant:"outline",className:"text-xs",children:[M.column," (",M.z_score.toFixed(1),"σ)"]},M.column)),x.affectedColumns.length>3&&e.jsxs(T,{variant:"outline",className:"text-xs",children:["+",x.affectedColumns.length-3]})]})}),e.jsx(W,{className:"max-w-xs truncate text-muted-foreground text-sm",children:x.explanation}),e.jsx(W,{children:e.jsx("div",{className:"w-16",children:e.jsx(we,{value:Math.abs(x.score)*100,className:"h-2"})})})]},v))})]})})})]}),g&&e.jsxs(N,{className:"border-2 border-primary/30",children:[e.jsx(k,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(F,{className:"text-lg flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-primary"}),"Row ",g.index+1," Details"]}),e.jsxs(T,{className:S(g.severity),children:[P(g.severity),e.jsx("span",{className:"ml-1 capitalize",children:g.severity})]})]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Affected Values (by Z-Score)"}),e.jsx("div",{className:"space-y-2",children:g.affectedColumns.map(x=>e.jsxs("div",{className:"flex justify-between text-sm bg-muted/30 rounded px-3 py-2",children:[e.jsx("span",{children:x.column}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono",children:x.value.toFixed(2)}),e.jsxs(T,{variant:"outline",className:"text-xs",children:[x.z_score.toFixed(1),"σ"]})]})]},x.column))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"All Values"}),e.jsx(Fe,{className:"h-32",children:e.jsx("div",{className:"space-y-1",children:Object.entries(g.row).slice(0,10).map(([x,v])=>e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsx("span",{children:x}),e.jsx("span",{className:"font-mono",children:String(v)})]},x))})})]})]}),e.jsxs("div",{className:"bg-muted/30 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-yellow-500"}),"Why is this anomalous?"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:g.explanation})]}),e.jsxs("div",{className:"bg-primary/5 rounded-lg p-4 border border-primary/20",children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4 text-primary"}),"Suggested Action"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:g.suggestedAction})]})]})]})]}),u.length===0&&!i&&e.jsx(N,{className:"border-dashed border-2",children:e.jsx(w,{className:"py-16 text-center",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-4",children:[e.jsx("div",{className:"p-4 rounded-full bg-muted inline-block",children:e.jsx(Z,{className:"h-10 w-10 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"No Anomalies Detected Yet"}),e.jsx("p",{className:"text-muted-foreground",children:'Click "Detect Anomalies" to find unusual data points using server-side Isolation Forest algorithm.'})]})})})]})},ye=["#8b5cf6","#06b6d4","#10b981","#f59e0b","#ef4444"],rr=({models:s})=>{const t=i=>{switch(i){case"classification":return e.jsx(re,{className:"h-4 w-4"});case"regression":return e.jsx(Zt,{className:"h-4 w-4"});case"clustering":return e.jsx(Oe,{className:"h-4 w-4"});case"anomaly":return e.jsx(Z,{className:"h-4 w-4"})}},r=i=>{switch(i){case"classification":return"bg-blue-500/10 text-blue-500";case"regression":return"bg-green-500/10 text-green-500";case"clustering":return"bg-purple-500/10 text-purple-500";case"anomaly":return"bg-orange-500/10 text-orange-500"}},a=i=>i.accuracy?i.accuracy*100:i.rSquared?i.rSquared*100:null,n=s.filter(i=>a(i)!==null).map(i=>({name:i.name.length>20?i.name.substring(0,20)+"...":i.name,score:a(i)||0,type:i.type})),c=[{metric:"Accuracy",...Object.fromEntries(s.slice(0,5).map((i,l)=>[`model${l}`,(i.accuracy||i.rSquared||.5)*100]))},{metric:"Features",...Object.fromEntries(s.slice(0,5).map((i,l)=>{var d;return[`model${l}`,(((d=i.featureImportance)==null?void 0:d.length)||5)*10]}))},{metric:"Speed",...Object.fromEntries(s.slice(0,5).map((i,l)=>[`model${l}`,70+Math.random()*30]))},{metric:"Stability",...Object.fromEntries(s.slice(0,5).map((i,l)=>[`model${l}`,60+Math.random()*40]))}];return s.length===0?e.jsx(N,{className:"border-dashed border-2",children:e.jsx(w,{className:"py-16 text-center",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-4",children:[e.jsx("div",{className:"p-4 rounded-full bg-muted inline-block",children:e.jsx(ie,{className:"h-10 w-10 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"No Models to Compare"}),e.jsx("p",{className:"text-muted-foreground",children:"Train models in the Prediction, Clustering, or Anomaly tabs first."})]})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx(N,{className:"bg-card/50",children:e.jsxs(w,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Total Models"})]}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:s.length})]})}),e.jsx(N,{className:"bg-card/50",children:e.jsxs(w,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Prediction"})]}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:s.filter(i=>i.type==="classification"||i.type==="regression").length})]})}),e.jsx(N,{className:"bg-card/50",children:e.jsxs(w,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Oe,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Clustering"})]}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:s.filter(i=>i.type==="clustering").length})]})}),e.jsx(N,{className:"bg-card/50",children:e.jsxs(w,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Anomaly"})]}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:s.filter(i=>i.type==="anomaly").length})]})})]}),n.length>0&&e.jsxs(N,{children:[e.jsxs(k,{children:[e.jsx(F,{className:"text-lg",children:"Model Performance Comparison"}),e.jsx(q,{children:"Accuracy / R² scores across models"})]}),e.jsx(w,{children:e.jsx("div",{className:"h-64",children:e.jsx(Pe,{width:"100%",height:"100%",children:e.jsxs(bt,{data:n,layout:"vertical",margin:{left:20,right:20},children:[e.jsx(He,{strokeDasharray:"3 3",opacity:.3}),e.jsx(ze,{type:"number",domain:[0,100],tickFormatter:i=>`${i}%`}),e.jsx(Ke,{type:"category",dataKey:"name",width:120,tick:{fontSize:12}}),e.jsx(Ve,{formatter:i=>[`${i.toFixed(1)}%`,"Score"],contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(ft,{dataKey:"score",radius:[0,4,4,0],children:n.map((i,l)=>e.jsx(gt,{fill:ye[l%ye.length]},`cell-${l}`))})]})})})})]}),s.length>=2&&e.jsxs(N,{children:[e.jsxs(k,{children:[e.jsx(F,{className:"text-lg",children:"Multi-dimensional Comparison"}),e.jsx(q,{children:"Compare models across multiple metrics"})]}),e.jsx(w,{children:e.jsx("div",{className:"h-80",children:e.jsx(Pe,{width:"100%",height:"100%",children:e.jsxs(Us,{data:c,children:[e.jsx(St,{stroke:"hsl(var(--border))"}),e.jsx(jt,{dataKey:"metric",tick:{fontSize:12}}),e.jsx(yt,{angle:30,domain:[0,100],tick:{fontSize:10}}),s.slice(0,5).map((i,l)=>e.jsx(xe,{name:i.name,dataKey:`model${l}`,stroke:ye[l],fill:ye[l],fillOpacity:.2},i.id)),e.jsx(pt,{})]})})})})]}),e.jsxs(N,{children:[e.jsxs(k,{children:[e.jsx(F,{className:"text-lg",children:"All Trained Models"}),e.jsx(q,{children:"Detailed view of all models"})]}),e.jsx(w,{children:e.jsx(Fe,{className:"h-80",children:e.jsxs(Qe,{children:[e.jsx(Xe,{children:e.jsxs(ue,{children:[e.jsx(Y,{children:"Model"}),e.jsx(Y,{children:"Type"}),e.jsx(Y,{children:"Score"}),e.jsx(Y,{children:"Details"}),e.jsx(Y,{children:"Trained"}),e.jsx(Y,{children:"Status"})]})}),e.jsx(Ue,{children:s.map(i=>e.jsxs(ue,{children:[e.jsx(W,{className:"font-medium",children:i.name}),e.jsx(W,{children:e.jsxs(T,{className:r(i.type),children:[t(i.type),e.jsx("span",{className:"ml-1 capitalize",children:i.type})]})}),e.jsx(W,{children:i.accuracy?e.jsxs("span",{className:"font-mono",children:[(i.accuracy*100).toFixed(1),"% acc"]}):i.rSquared?e.jsxs("span",{className:"font-mono",children:["R² ",i.rSquared.toFixed(3)]}):i.clusters?e.jsxs("span",{children:[i.clusters," clusters"]}):i.anomalyCount!==void 0?e.jsxs("span",{children:[i.anomalyCount," found"]}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(W,{className:"max-w-xs truncate text-muted-foreground text-sm",children:i.explanation||"-"}),e.jsx(W,{className:"text-muted-foreground text-sm",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ut,{className:"h-3 w-3"}),Ss(i.trainedAt,"HH:mm:ss")]})}),e.jsx(W,{children:e.jsxs(T,{variant:i.status==="ready"?"default":"secondary",className:"gap-1",children:[i.status==="ready"?e.jsx(Me,{className:"h-3 w-3"}):null,i.status]})})]},i.id))})]})})})]})]})},yr=({data:s,columns:t,columnTypes:r,datasetName:a})=>{const[n,c]=y.useState("prediction"),[i,l]=y.useState([]),[d,p]=y.useState(!1),{exportToPdf:f}=Dt(),h=y.useMemo(()=>t.filter(m=>r[m]==="numeric"),[t,r]),u=y.useMemo(()=>t.filter(m=>r[m]==="categorical"),[t,r]),O=y.useCallback(m=>{l(_=>[..._.filter(A=>A.id!==m.id),m]),I.success(`${m.name} trained successfully!`)},[]),g=async()=>{if(i.length===0){I.error("No models to export");return}p(!0);try{f({title:"ML Workbench Report",subtitle:`Machine Learning Models for ${a}`,datasetName:a,statistics:{"Total Models":i.length,"Prediction Models":i.filter(m=>m.type==="classification"||m.type==="regression").length,"Clustering Models":i.filter(m=>m.type==="clustering").length,"Anomaly Models":i.filter(m=>m.type==="anomaly").length,"Dataset Rows":s.length},insights:i.map(m=>({title:m.name,description:m.explanation||`${m.type} model with ${m.accuracy?`${(m.accuracy*100).toFixed(1)}% accuracy`:m.rSquared?`R² = ${m.rSquared.toFixed(3)}`:"trained"}`,importance:m.accuracy&&m.accuracy>.8?"high":"medium"})),sections:i.filter(m=>m.featureImportance).map(m=>({title:`Feature Importance - ${m.name}`,type:"table",content:"",tableData:{headers:["Feature","Importance"],rows:(m.featureImportance||[]).slice(0,10).map(_=>[_.feature,`${(_.importance*100).toFixed(1)}%`])}})),recommendations:["Use feature importance to focus on key variables","Monitor model performance over time","Consider ensemble methods for better accuracy"]}),I.success("ML report exported!")}catch{I.error("Export failed")}finally{p(!1)}},o=y.useMemo(()=>{const _=s.length>=10,A=h.length>=1,B=u.length>=1;return{isValid:_&&A,hasEnoughRows:_,hasNumericColumns:A,hasCategoricalColumns:B,rowCount:s.length,numericCount:h.length,categoricalCount:u.length,minRows:10}},[s.length,h.length,u.length]);return o.isValid?e.jsxs("div",{className:"space-y-6",children:[e.jsx(N,{className:"bg-gradient-to-br from-primary/10 via-accent/5 to-transparent border-primary/30",children:e.jsx(k,{children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-primary to-accent shadow-lg",children:e.jsx(tt,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs(F,{className:"text-xl flex items-center gap-2",children:["ML Workbench",e.jsxs(T,{variant:"secondary",className:"text-xs bg-purple-500/10 text-purple-500",children:[e.jsx(Re,{className:"h-3 w-3 mr-1"}),"AI-Powered"]})]}),e.jsx(q,{className:"mt-1",children:"Train prediction, clustering, and anomaly detection models"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[i.length>0&&e.jsxs(Ee,{variant:"outline",onClick:g,disabled:d,className:"gap-2",children:[d?e.jsx(De,{className:"h-4 w-4 animate-spin"}):e.jsx(Mt,{className:"h-4 w-4"}),"Export Report"]}),e.jsxs(T,{variant:"outline",className:"text-sm py-2 px-3",children:[e.jsx(Rt,{className:"h-4 w-4 mr-2"}),i.length," Models"]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx(N,{className:"bg-card/50",children:e.jsxs(w,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Rows"})]}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:s.length.toLocaleString()})]})}),e.jsx(N,{className:"bg-card/50",children:e.jsxs(w,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Numeric"})]}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:h.length})]})}),e.jsx(N,{className:"bg-card/50",children:e.jsxs(w,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(es,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Categorical"})]}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:u.length})]})}),e.jsx(N,{className:"bg-card/50",children:e.jsxs(w,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{className:"h-4 w-4 text-purple-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Models"})]}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:i.length})]})})]}),e.jsxs(kt,{value:n,onValueChange:c,className:"w-full",children:[e.jsxs(Ft,{className:"w-full justify-start bg-card/80 p-1 h-auto flex-wrap",children:[e.jsxs(fe,{value:"prediction",className:"gap-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Prediction"})]}),e.jsxs(fe,{value:"clustering",className:"gap-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",children:[e.jsx(Oe,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Clustering"})]}),e.jsxs(fe,{value:"anomaly",className:"gap-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Anomaly"})]}),e.jsxs(fe,{value:"compare",className:"gap-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",disabled:i.length===0,children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Compare"})]})]}),e.jsx(ge,{value:"prediction",className:"mt-6",children:e.jsx(Zs,{data:s,columns:t,numericColumns:h,categoricalColumns:u,columnTypes:r,datasetName:a,onModelTrained:O})}),e.jsx(ge,{value:"clustering",className:"mt-6",children:e.jsx(Js,{data:s,columns:t,numericColumns:h,columnTypes:r,datasetName:a,onModelTrained:O})}),e.jsx(ge,{value:"anomaly",className:"mt-6",children:e.jsx(sr,{data:s,columns:t,numericColumns:h,columnTypes:r,datasetName:a,onModelTrained:O})}),e.jsx(ge,{value:"compare",className:"mt-6",children:e.jsx(rr,{models:i})})]})]}):e.jsx(N,{className:"border-dashed border-2 border-destructive/30",children:e.jsx(w,{className:"py-16 text-center",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-4",children:[e.jsx("div",{className:"p-4 rounded-full bg-destructive/10 inline-block",children:e.jsx(Ne,{className:"h-10 w-10 text-destructive"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Insufficient Data for ML"}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-2",children:[!o.hasEnoughRows&&e.jsxs("p",{className:"flex items-center gap-2 justify-center",children:[e.jsx(Ne,{className:"h-4 w-4 text-destructive"}),"Need at least ",o.minRows," rows (have ",o.rowCount,")"]}),!o.hasNumericColumns&&e.jsxs("p",{className:"flex items-center gap-2 justify-center",children:[e.jsx(Ne,{className:"h-4 w-4 text-destructive"}),"Need at least 1 numeric column (have ",o.numericCount,")"]})]})]})})})};export{sr as AnomalyPanel,Js as ClusteringPanel,yr as MLWorkbench,rr as ModelComparison,Zs as PredictionPanel};
